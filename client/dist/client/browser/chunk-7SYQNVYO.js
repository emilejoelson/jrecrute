import{m as L,n as z,o as A,p as F,q as W,r as D}from"./chunk-ZMJW5JPU.js";import{a as S}from"./chunk-UZE7R2MP.js";import{p as R}from"./chunk-TYWYGKBN.js";import{k as N,l as T,n as U,q as k,r as B}from"./chunk-E3YMVHEH.js";import{$b as x,Bc as c,Cb as l,Cc as p,Ec as C,Nb as d,Pb as h,Xb as s,Yb as i,_b as f,da as _,dc as y,ec as u,j as I,mb as r,nc as v,oc as a,qc as b,rb as P,rc as M,sc as $,xb as w}from"./chunk-VJULP7QK.js";function V(n,e){n&1&&(s(0,"div"),a(1,"Loading subscribers..."),i())}function G(n,e){if(n&1&&(s(0,"div",12),a(1),i()),n&2){let t=e.ngIf;r(),b(" Error: ",t," ")}}function J(n,e){if(n&1&&(s(0,"li"),a(1),i()),n&2){let t=e.$implicit;r(),M(" ",t.email," - ",t.isConfirmed?"Confirmed":"Unconfirmed"," ")}}function q(n,e){if(n&1&&(f(0),s(1,"p"),a(2),i(),s(3,"ul"),l(4,J,2,2,"li",14),i(),x()),n&2){let t=u().ngIf,o=u(3);r(2),b("Subscribers found: ",t.length,""),r(2),d("ngForOf",t)("ngForTrackBy",o.trackBySubscriberId)}}function H(n,e){n&1&&(s(0,"p"),a(1,"No subscribers found (empty array)"),i())}function K(n,e){if(n&1&&(f(0),l(1,q,5,3,"ng-container",13)(2,H,2,0,"ng-template",null,1,C),x()),n&2){let t=e.ngIf,o=v(3);r(),d("ngIf",t.length>0)("ngIfElse",o)}}function Q(n,e){n&1&&(s(0,"p"),a(1,"Subscribers data is null/undefined"),i())}function X(n,e){if(n&1&&(s(0,"div"),l(1,K,4,2,"ng-container",13),c(2,"async"),l(3,Q,2,0,"ng-template",null,0,C),i()),n&2){let t=v(4),o=u(2);r(),d("ngIf",p(2,2,o.subscribers$))("ngIfElse",t)}}function Y(n,e){if(n&1&&(s(0,"div",9)(1,"h3"),a(2,"Subscribers Tab"),i(),l(3,V,2,0,"div",10),c(4,"async"),l(5,G,2,1,"div",11),c(6,"async"),l(7,X,5,4,"div",10),c(8,"async"),c(9,"async"),i()),n&2){let t=u();r(3),d("ngIf",p(4,3,t.subscribersLoading$)),r(2),d("ngIf",p(6,5,t.subscribersError$)),r(2),d("ngIf",!p(8,7,t.subscribersLoading$)&&!p(9,9,t.subscribersError$))}}function Z(n,e){n&1&&(s(0,"div"),a(1,"Loading users..."),i())}function ee(n,e){if(n&1&&(s(0,"div",12),a(1),i()),n&2){let t=e.ngIf;r(),b(" Error: ",t," ")}}function te(n,e){if(n&1&&(s(0,"li"),a(1),i()),n&2){let t=e.$implicit;r(),$(" ",t.personalInfo.firstName," ",t.personalInfo.lastName," - ",t.personalInfo.email," ")}}function ne(n,e){if(n&1&&(f(0),s(1,"p"),a(2),i(),s(3,"ul"),l(4,te,2,3,"li",14),i(),x()),n&2){let t=u().ngIf,o=u(3);r(2),b("Users found: ",t.length,""),r(2),d("ngForOf",t)("ngForTrackBy",o.trackByUserId)}}function ie(n,e){n&1&&(s(0,"p"),a(1,"No users found (empty array)"),i())}function re(n,e){if(n&1&&(f(0),l(1,ne,5,3,"ng-container",13)(2,ie,2,0,"ng-template",null,3,C),x()),n&2){let t=e.ngIf,o=v(3);r(),d("ngIf",t.length>0)("ngIfElse",o)}}function se(n,e){n&1&&(s(0,"p"),a(1,"Users data is null/undefined"),i())}function oe(n,e){if(n&1&&(s(0,"div"),l(1,re,4,2,"ng-container",13),c(2,"async"),l(3,se,2,0,"ng-template",null,2,C),i()),n&2){let t=v(4),o=u(2);r(),d("ngIf",p(2,2,o.usersWithCv$))("ngIfElse",t)}}function ae(n,e){if(n&1&&(s(0,"div",9)(1,"h3"),a(2,"Users Tab"),i(),l(3,Z,2,0,"div",10),c(4,"async"),l(5,ee,2,1,"div",11),c(6,"async"),l(7,oe,5,4,"div",10),c(8,"async"),c(9,"async"),i()),n&2){let t=u();r(3),d("ngIf",p(4,3,t.usersLoading$)),r(2),d("ngIf",p(6,5,t.usersError$)),r(2),d("ngIf",!p(8,7,t.usersLoading$)&&!p(9,9,t.usersError$))}}var j=class n{constructor(e){this.store=e;this.subscribers$=this.store.select(L),this.subscribersLoading$=this.store.select(z),this.subscribersError$=this.store.select(A),this.usersWithCv$=this.store.select(F),this.usersLoading$=this.store.select(W),this.usersError$=this.store.select(D)}destroy$=new I;subscribers=[];users=[];subscribersLoading=!1;usersLoading=!1;subscribers$;usersWithCv$;subscribersLoading$;usersLoading$;subscribersError$;usersError$;activeTab="subscribers";ngOnInit(){this.loadSubscribers(),this.loadUsers(),this.subscribers$.pipe(_(this.destroy$)).subscribe(e=>{console.log("Subscribers received:",e),this.subscribers=e||[]}),this.usersWithCv$.pipe(_(this.destroy$)).subscribe(e=>{console.log("Users received:",e),this.users=e||[]}),this.subscribersLoading$.pipe(_(this.destroy$)).subscribe(e=>{this.subscribersLoading=e}),this.usersLoading$.pipe(_(this.destroy$)).subscribe(e=>{this.usersLoading=e})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadSubscribers(){this.store.dispatch(S.loadAllSubscribers())}loadUsers(){this.store.dispatch(S.loadUsersWithCv())}selectRecipient(e,t){console.log("Selected recipient:",{type:e,recipient:t})}viewCv(e){e.cvFile&&console.log("View CV for user:",e)}getConfirmedCount(e){return!e||!Array.isArray(e)?0:e.filter(t=>t.isConfirmed).length}getTotalRecipients(e,t){let o=e&&Array.isArray(e)?e.length:0,m=t&&Array.isArray(t)?t.length:0;return o+m}trackBySubscriberId(e,t){return t._id}trackByUserId(e,t){return t._id}debugData(){this.subscribers$.subscribe(e=>{console.log("Subscribers data:",e)}),this.usersWithCv$.subscribe(e=>{console.log("Users data:",e)})}static \u0275fac=function(t){return new(t||n)(P(R))};static \u0275cmp=w({type:n,selectors:[["app-newsletter-recipients"]],decls:41,vars:40,consts:[["noSubscribers",""],["emptySubscribers",""],["noUsers",""],["emptyUsers",""],[1,"newsletter-recipients-container"],[1,"debug-section"],[1,"tab-navigation"],[1,"tab-button",3,"click"],["class","tab-content",4,"ngIf"],[1,"tab-content"],[4,"ngIf"],["class","error",4,"ngIf"],[1,"error"],[4,"ngIf","ngIfElse"],[4,"ngFor","ngForOf","ngForTrackBy"]],template:function(t,o){if(t&1&&(s(0,"div",4)(1,"h2"),a(2,"Newsletter Recipients Management - DEBUG"),i(),s(3,"div",5)(4,"h3"),a(5,"Debug Info:"),i(),s(6,"p"),a(7),c(8,"async"),i(),s(9,"p"),a(10),c(11,"async"),i(),s(12,"p"),a(13),c(14,"async"),i(),s(15,"p"),a(16),c(17,"async"),i(),s(18,"p"),a(19),c(20,"async"),i(),s(21,"p"),a(22),c(23,"async"),i(),s(24,"pre"),a(25),c(26,"async"),c(27,"json"),i(),s(28,"pre"),a(29),c(30,"async"),c(31,"json"),i()(),s(32,"div",6)(33,"button",7),y("click",function(){return o.activeTab="subscribers"}),a(34),c(35,"async"),i(),s(36,"button",7),y("click",function(){return o.activeTab="users"}),a(37),c(38,"async"),i()(),l(39,Y,10,11,"div",8)(40,ae,10,11,"div",8),i()),t&2){let m,g,O,E;r(7),b("Subscribers loading: ",p(8,16,o.subscribersLoading$),""),r(3),b("Subscribers error: ",p(11,18,o.subscribersError$),""),r(3),b("Users loading: ",p(14,20,o.usersLoading$),""),r(3),b("Users error: ",p(17,22,o.usersError$),""),r(3),b("Subscribers count: ",(m=(m=p(20,24,o.subscribers$))==null?null:m.length)!==null&&m!==void 0?m:"loading...",""),r(3),b("Users count: ",(g=(g=p(23,26,o.usersWithCv$))==null?null:g.length)!==null&&g!==void 0?g:"loading...",""),r(3),b("Subscribers data: ",p(27,30,p(26,28,o.subscribers$)),""),r(4),b("Users data: ",p(31,34,p(30,32,o.usersWithCv$)),""),r(4),h("active",o.activeTab==="subscribers"),r(),b(" Subscribers (",((O=p(35,36,o.subscribers$))==null?null:O.length)||0,") "),r(2),h("active",o.activeTab==="users"),r(),b(" Users with CV (",((E=p(38,38,o.usersWithCv$))==null?null:E.length)||0,") "),r(2),d("ngIf",o.activeTab==="subscribers"),r(),d("ngIf",o.activeTab==="users")}},dependencies:[B,N,T,U,k],styles:[".newsletter-recipients-container[_ngcontent-%COMP%]{padding:20px;max-width:1200px;margin:0 auto}.tab-navigation[_ngcontent-%COMP%]{display:flex;margin-bottom:20px;border-bottom:2px solid #e0e0e0}.tab-button[_ngcontent-%COMP%]{padding:12px 24px;border:none;background:none;cursor:pointer;font-size:16px;font-weight:500;color:#666;border-bottom:3px solid transparent;transition:all .3s ease}.tab-button[_ngcontent-%COMP%]:hover{color:#333;background-color:#f5f5f5}.tab-button.active[_ngcontent-%COMP%]{color:#007bff;border-bottom-color:#007bff;background-color:#f8f9fa}.tab-content[_ngcontent-%COMP%]{min-height:400px}.section-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.section-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:#333}.refresh-btn[_ngcontent-%COMP%]{padding:8px 16px;border:1px solid #ddd;background:#fff;border-radius:4px;cursor:pointer;font-size:14px;transition:all .3s ease}.refresh-btn[_ngcontent-%COMP%]:hover{background:#f8f9fa;border-color:#aaa}.loading[_ngcontent-%COMP%], .error[_ngcontent-%COMP%], .no-data[_ngcontent-%COMP%]{text-align:center;padding:40px;font-size:16px}.loading[_ngcontent-%COMP%]{color:#666}.error[_ngcontent-%COMP%]{color:#dc3545;background-color:#f8d7da;border:1px solid #f5c6cb;border-radius:4px}.no-data[_ngcontent-%COMP%]{color:#6c757d;background-color:#f8f9fa;border-radius:4px}.recipients-list[_ngcontent-%COMP%]{display:grid;gap:16px;grid-template-columns:repeat(auto-fill,minmax(400px,1fr))}.recipient-card[_ngcontent-%COMP%]{border:1px solid #ddd;border-radius:8px;padding:16px;background:#fff;box-shadow:0 2px 4px #0000001a;transition:box-shadow .3s ease}.recipient-card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 8px #00000026}.subscriber-card[_ngcontent-%COMP%]{border-left:4px solid #28a745}.user-card[_ngcontent-%COMP%]{border-left:4px solid #007bff}.recipient-info[_ngcontent-%COMP%]{flex:1}.recipient-name[_ngcontent-%COMP%]{font-weight:600;font-size:16px;color:#333;margin-bottom:4px}.recipient-email[_ngcontent-%COMP%]{font-size:14px;color:#666;margin-bottom:8px}.recipient-meta[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:center;font-size:12px}.status[_ngcontent-%COMP%]{padding:2px 8px;border-radius:12px;font-weight:500;text-transform:uppercase;font-size:11px}.status.confirmed[_ngcontent-%COMP%]{background-color:#d4edda;color:#155724}.status.unconfirmed[_ngcontent-%COMP%]{background-color:#fff3cd;color:#856404}.cv-status[_ngcontent-%COMP%]{padding:2px 8px;border-radius:12px;background-color:#cce5ff;color:#004085;font-weight:500;text-transform:uppercase;font-size:11px}.date[_ngcontent-%COMP%]{color:#999}.recipient-actions[_ngcontent-%COMP%]{display:flex;gap:8px;margin-top:12px}.action-btn[_ngcontent-%COMP%]{padding:6px 12px;border:1px solid #007bff;background:#007bff;color:#fff;border-radius:4px;cursor:pointer;font-size:12px;transition:all .3s ease}.action-btn[_ngcontent-%COMP%]:hover{background:#0056b3;border-color:#0056b3}.action-btn.secondary[_ngcontent-%COMP%]{background:#fff;color:#007bff}.action-btn.secondary[_ngcontent-%COMP%]:hover{background:#f8f9fa}.summary-section[_ngcontent-%COMP%]{margin-top:40px;padding:20px;background:#f8f9fa;border-radius:8px;border:1px solid #e9ecef}.summary-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 16px;color:#333}.summary-stats[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px}.stat[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:12px;background:#fff;border-radius:6px;border:1px solid #dee2e6}.stat-label[_ngcontent-%COMP%]{font-weight:500;color:#666}.stat-value[_ngcontent-%COMP%]{font-weight:600;font-size:18px;color:#333}@media (max-width: 768px){.recipients-list[_ngcontent-%COMP%], .summary-stats[_ngcontent-%COMP%]{grid-template-columns:1fr}.section-header[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch;gap:12px}}"]})};export{j as NewsletterRecipientsComponent};
