import{a as h}from"./chunk-XHYYKJWM.js";import{r as l}from"./chunk-JPPVI7S5.js";import{Pa as u,d as e,ia as n,k as r,na as s}from"./chunk-LGAK75AS.js";var c=class a{constructor(t,i){this.platformId=t;this.translationService=i;this.isBrowser=l(this.platformId),this.currentLanguage=this.translationService.getCurrentLang(),this.isBrowser&&(this.initAudio(),setInterval(()=>{let o=this.translationService.getCurrentLang();o!==this.currentLanguage&&(this.currentLanguage=o,this.handleLanguageChange())},1e3))}audio=null;currentTime=new r(0);isPlaying=new r(!1);isBrowser;currentLanguage;currentTime$=this.currentTime.asObservable();isPlaying$=this.isPlaying.asObservable();content={EN:{title:"Consult Collab",subtitle:"Your partner to maximize your potential",audioPath:"assets/audio/cc-recrute-english.mp3"},FR:{title:"Consult Collab",subtitle:"Votre partenaire pour maximiser votre potentiel",audioPath:"assets/audio/cc-recrute-french.mp3"}};initAudio(){return e(this,null,function*(){this.destroyAudio();let t=this.content[this.currentLanguage].audioPath;this.audio=new Audio(t),this.audio.preload="auto",this.audio.volume=.6;try{yield this.audio.load(),this.setupAudioListeners()}catch(i){console.error("Error loading audio:",i)}})}destroyAudio(){this.audio&&(this.audio.pause(),this.audio.src="",this.audio.removeAttribute("src"),this.audio.load(),this.audio=null)}handleLanguageChange(){return e(this,null,function*(){let t=this.isPlaying.value,i=this.currentTime.value;yield this.initAudio(),this.audio&&(this.audio.currentTime=i,t&&this.play())})}getCurrentContent(){return this.content[this.currentLanguage]}play(){return e(this,null,function*(){if(!(!this.isBrowser||!this.audio))try{yield this.audio.play(),this.isPlaying.next(!0)}catch(t){console.error("Playback failed:",t),setTimeout(()=>this.play(),1e3)}})}autoplay(){return e(this,null,function*(){if(!(!this.isBrowser||!this.audio))try{yield this.play()}catch(t){console.error("Autoplay failed:",t),setTimeout(()=>this.autoplay(),1e3)}})}setupAudioListeners(){this.audio&&(this.audio.ontimeupdate=()=>{this.currentTime.next(this.audio?.currentTime||0)},this.audio.onended=()=>{this.stop()},this.audio.onerror=()=>{console.error("Audio error:",this.audio?.error),this.stop(),setTimeout(()=>this.play(),1e3)})}pause(){this.audio?.pause(),this.isPlaying.next(!1)}resume(){this.play()}stop(){this.audio&&(this.audio.pause(),this.audio.currentTime=0),this.isPlaying.next(!1),this.currentTime.next(0)}getTotalDuration(){return this.audio?.duration||72}ngOnDestroy(){this.destroyAudio()}static \u0275fac=function(i){return new(i||a)(s(u),s(h))};static \u0275prov=n({token:a,factory:a.\u0275fac,providedIn:"root"})};export{c as a};
