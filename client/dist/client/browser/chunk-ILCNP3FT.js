import{q as u}from"./chunk-QCKORCBF.js";import{Qa as s,d as a,ia as r,k as e,na as o}from"./chunk-OZJJMYSU.js";var n=class i{constructor(t){this.platformId=t;this.isBrowser=u(this.platformId),this.isBrowser&&this.initAudio()}audio=null;currentTime=new e(0);isPlaying=new e(!1);isBrowser;volumeInterval;currentTime$=this.currentTime.asObservable();isPlaying$=this.isPlaying.asObservable();content={title:"Consult Collab",subtitle:"Votre partenaire pour maximiser votre potentiel",audioPath:"assets/audio/cc-recrute.mp3"};initAudio(){this.audio=new Audio(this.content.audioPath),this.audio.preload="auto",this.audio.volume=0,this.audio.muted=!0}autoplay(){return a(this,null,function*(){if(!(!this.isBrowser||!this.audio))try{this.audio.muted=!0,yield this.audio.play(),setTimeout(()=>{this.audio&&(this.audio.muted=!1,this.startVolumeFade())},100),this.isPlaying.next(!0),this.setupAudioListeners()}catch(t){console.error("Autoplay failed:",t),this.retryAutoplay()}})}retryAutoplay(){setTimeout(()=>{this.autoplay()},1e3)}startVolumeFade(){if(!this.audio)return;let t=.6;this.audio.volume=t,this.volumeInterval&&clearInterval(this.volumeInterval),this.volumeInterval=setInterval(()=>{t=Math.min(t+.1,1),this.audio&&(this.audio.volume=t),t>=1&&clearInterval(this.volumeInterval)},200)}setupAudioListeners(){this.audio&&(this.audio.ontimeupdate=()=>{this.currentTime.next(this.audio?.currentTime||0)},this.audio.onended=()=>{this.stop()})}pause(){this.volumeInterval&&clearInterval(this.volumeInterval),this.audio?.pause(),this.isPlaying.next(!1)}resume(){this.audio?.play(),this.isPlaying.next(!0)}stop(){this.volumeInterval&&clearInterval(this.volumeInterval),this.audio&&(this.audio.pause(),this.audio.currentTime=0),this.isPlaying.next(!1),this.currentTime.next(0)}getTotalDuration(){return this.audio?.duration||72}static \u0275fac=function(l){return new(l||i)(o(s))};static \u0275prov=r({token:i,factory:i.\u0275fac,providedIn:"root"})};export{n as a};
